---
title: 解放双手 全自动检查iptv地址并整理为一个M3U文件
description: 
date: 2022-08-17
slug: iptvchecker
image: 
categories:
    - software
tags:
    - Github
    - Developing

---

## 开场
项目在这里 [iptvchecker](https://github.com/gek64/iptvchecker)，为什么想做这个软件呢，其实是想把某些网站提供的在线视频直播地址直接转换为一个m3u文件在电视上用kodi来直接播放，基本上通过查看调试工具或者抓包很容易获取到这些在线视频的某一个直播的URL，但是要对很多个直播地址进行重复操作费时费力，所以就想到了干脆写一个按照一定的规律来检测这些直播地址，并通过返回的数据是不是一个有效的m3u文件来批量把很多的直播源合成一个m3u节目单便于后续的处理。


## 基本信息


## 升级过程
### v1.00
- 发布日期: 2022-8-16

其实这个程序在一年前大致的功能就已经变成完成了，当时的想法很简单就是一个检查函数、一个制作m3u文件函数、一个主函数调用其他两个函数，没有什么可以交互的cli，在发布的这个版本中，加入了基本的命令行提示，将整个程序做成了一个命令行工具。

### v1.01
- 发布日期: 2022-8-17

这个版本主要是加入了协程，这种程序其实是最适合多线程处理的，虽然说协程这个东西还远没有到线程的级别，这个版本主要加入协程，让所有的url检查能并行检查，但是因为如果发送速率太快可能会遭到服务器的拒绝，正好在复习计算机网络链路层的时候学到了一个**滑动窗口机制**，里面的 **后退N帧协议（GBN）** 提出的这个方法，似乎可以很好的解决这个发送检查请求速率控制的问题，下一个版本会考虑加入这个改善。

#### 2022-8-18
- https://github.com/gek64/test/tree/main/channel

重新查看了文档，在并行运行的同时进行流量控制需要使用2个信道，一个信道用于同步主进程与发送出去的协程，一个信道用于流量控制。

同步过程，类似于同样有一个管道，协程向里面塞信息，每次塞入信息，主进程就会从中拿出信息，等全部信息都拿完了，主进程才会做下一步操作，就完成了同步。

流量控制，类似于一个固定长度的管道，主进程往里面塞信息，塞满了就只能等待协程从管道中拿出信息，管道里面的信息被拿走以后主进程才能继续塞入新的信息，就完成了流量控制。

同时同步控制可以由1.直接使用chan 2.使用了封装了chan的sync包来进行同步的控制。[chan + sync 进行并行运行与流量控制](https://github.com/gek64/test/blob/main/channel/flow%20control%20use%20chan%20and%20wg.go)

同时流量控制只能使用chan来进行控制。[chan 进行并行运行与流量控制](https://github.com/gek64/test/blob/main/channel/flow%20control%20use%20chan%20.go)



## s2