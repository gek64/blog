---
title: 开源软件-iptvchecker
description: 多m3u链接检测合并软件
date: 2022-08-17
slug: iptvchecker
image: 
categories:
    - software
tags:
    - Github
    - Developing

---

## 开场
Github 地址 [iptvchecker](https://github.com/gek64/iptvchecker)，

### 这是一个什么软件
这是一个按照一定的数列排序规则，比如说1 3 5 7 9 代表从1开始 到9结束，每个间隔为2的数列，遍历一个网址上的一定量的链接，并通过返回参数判断这个链接是否指向一个m3u的流媒体，并把多个流媒体按节目号拼接成一个m3u文件的软件。

这样说也许会很复杂，但实际上就是一个"暴力"批量"扫描"合并m3u视频源的软件，虽然本程序一点也不暴力，也没有任何扫描的功能。


## 升级过程
### v1.00
- 发布日期: 2022-8-16

其实这个程序在一年前大致的功能就已经变成完成了，当时的想法很简单，一共三个函数，一个检查url函数是否为合法的m3u地址、一个合并m3u文件函数、一个主函数填写对应的基础url并调用其他两个函数。

一开始的版本并没有什么复杂的东西，但是随着m3u地址变来变去（大概两三个月一次），每一次我都要去重新看一看我原来写的代码到底是个什么意思，干脆就如同我之前写的那些命令行工具一样，把这个程序也做成了命令行工具。

### v1.01
- 发布日期: 2022-8-17

这个版本主要是加入了协程，这种程序其实是最适合多线程处理的，虽然说协程这个东西还远没有到线程的级别，这个版本主要加入协程，让所有的url检查能并行检查，正好受到在计算机网络中的**滑动窗口机制**和**后退N帧协议（GBN）** 的启发，使用了一套能一次性并行执行的多线程程序。

但这个版本有个问题，就是不能控制发送的速率，协程会一口气全部发送请求，可能会触发对应服务端的一些拒绝服务。

### v1.02
- 发布日期: 2022-8-20

#### 2022-8-18
- https://github.com/gek64/test/tree/main/channel

重新查看了相关的文档，要实现(1)主进程和协程同步(2)协程有数量限制的执行，必须得有两个信道，一个信道用于同步主进程与协程，一个信道用于流量控制。

在同步过程阶段，需要一个使主进程停止等待协程完成任务得管道。

##### 在流量控制阶段，有两种控制流量的方法：
1. 使用主进程控制发出的协程数量，这个方法有个问题，如果本身协程就需要在运行完成后发送一个信息给主进程，使用这种方法就会使得主进程卡在发送协程的阶段，无法进入与协程通讯的阶段，从而导致死锁。

2. 协程间相互控制执行的数量，类似于消费者生产者问题，将缓冲管道的缓冲空闲数量作为生产者的产品，协程要干活作为消费者，消费者只有在有产品的时候才会去干活，这样虽然主进程一次性发送了所有的协程，但协程之间通过缓冲信道机制互相控制，不依靠主进程完成了速率控制。

基于方法2 制作了这一个版本的更新，默认的协程工作数目我想3-5比较合适，姑且就默认为3吧，也提供了自定义的命令行参数供大家使用。


## 协议
- 本软件采用(GNU General Public License v3.0)[https://github.com/gek64/iptvchecker/blob/main/LICENSE]协议。
- 如使用或者传播即代表同意以上协议，请仔细阅读协议内容，特别注意，本人对程序的使用不负任何责任，也不对程序的运行做任何的担保，谢谢。